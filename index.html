<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Yixin&#39;s sharing">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Yixin&#39;s sharing">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Ren Yixin">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Yixin's sharing</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Yixin's sharing</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/01/Hi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/01/Hi/" itemprop="url">Hi,guys! Welcome</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-01T16:56:17+08:00">
                2019-09-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  147
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="welcome-to-my-blog"><strong>Welcome to my Blog! </strong></h1>
<hr>
<p><strong>This is the very first post in my blog, here I'm going to introduce to your guys who I am and why I establish this Blog.</strong></p>
<p>My name is <strong>Ren Yixin</strong>, an undergraduate student in Zhejiang university, China.</p>
<p>In this blog, I'm going to share with you anything I've learnt in my academic study and my life, including:</p>
<ul>
<li>My research dairy</li>
<li>Some technical review/prospect on a certain field eg: Addictive Manufacturing; Plastic processing;</li>
<li>Some attempts to do pioneering in my own business<br>
</li>
<li>Unlimited social comments</li>
<li>Why I laughed just now ...</li>
</ul>
<p>Thanks to internet, which gives me a free access to every of you. I believe that every bit of our single efforts will push a little boundry of infinite human world and is worth a listener.</p>
<p><strong>Contact me at:</strong></p>
<p><strong>Email</strong>: renyixin@zju.edu.cn</p>
<p><strong>Phone number/Wechat</strong>: +86 15857438969</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/16/%E6%95%B0%E6%8D%AE%E5%BA%93peewee/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/16/%E6%95%B0%E6%8D%AE%E5%BA%93peewee/" itemprop="url">数据库之peewee+sqlite入门级练手</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-16T18:32:01+08:00">
                2020-06-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%88%91%E7%9A%84%E5%B0%8F%E7%A7%91%E7%A0%94/" itemprop="url" rel="index">
                    <span itemprop="name">我的小科研</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  860
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="peewee_quickstart"><a class="markdownIt-Anchor" href="#peewee_quickstart"></a> Peewee_quickstart</h2>
<p>Peewee中<code>Model</code>类、<code>fields</code>和<code>model实例</code>与数据库的映射关系如下：</p>
<p>Model class—Database table</p>
<p>Field instance—Column on a table</p>
<p>Model instance—Row in a database table</p>
<p>一个Model类代表一个数据库的表,一个Field字段代表数据库中的一个字段而一个model类实例化对象则代表数据库中的一行;</p>
<h3 id="定义model-建立数据库"><a class="markdownIt-Anchor" href="#定义model-建立数据库"></a> 定义Model 建立数据库</h3>
<p>在使用的时候，根据需求先定义好Model，然后可以通过<code>create_tables()</code>创建表，若是已经创建好数据库表了，可以通过<code>python -m pwiz</code>脚本工具直接创建Model。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> peewee <span class="keyword">import</span> *</span><br><span class="line">db = SqliteDatabase(<span class="string">'quickstart.db'</span>)</span><br><span class="line">db.connect()</span><br><span class="line"><span class="comment">#连接数据库</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Material</span><span class="params">(Model)</span>:</span></span><br><span class="line">  name = CharField()</span><br><span class="line">  P1 = CharField()</span><br><span class="line">  P2 = BooleanField()</span><br><span class="line">  P3 = IntegerField()</span><br><span class="line">  </span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">    database = db</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建表</span></span><br><span class="line">Material.create_table()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建表也可以这样, 可以创建多个</span></span><br><span class="line"><span class="comment"># database.create_tables([Person])</span></span><br></pre></td></tr></table></figure>
<p>如果建完之后，发现缺少了一列，可以使用playhouse 里migrate模块进行修改（增删更名）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> playhouse.migrate <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这是postgresql的，实例化出一个migrator对象</span></span><br><span class="line">db = SqliteDatabase(<span class="string">'quickstart.db'</span>)</span><br><span class="line">migrator = SqliteMigrator(db)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用migrate()执行一个或多个操作</span></span><br><span class="line"><span class="comment"># 添加了两个列，删除一个列</span></span><br><span class="line">title_field = CharField(default=<span class="string">''</span>)</span><br><span class="line">status_field = IntegerField(null=<span class="literal">True</span>)</span><br><span class="line">migrate(</span><br><span class="line">    migrator.add_column(<span class="string">'Material'</span>, <span class="string">'title1'</span>,title_field),<span class="comment">#‘Material表’‘新增title属性’ </span></span><br><span class="line">    migrator.drop_column(<span class="string">'Material'</span>, <span class="string">'title1'</span>,title_field),<span class="comment">#‘Material表’‘新增title属性’</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="对数据的操作"><a class="markdownIt-Anchor" href="#对数据的操作"></a> 对数据的操作</h3>
<h4 id="增加"><a class="markdownIt-Anchor" href="#增加"></a> 增加</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#添加一条数据</span></span><br><span class="line">p = Material(name = <span class="string">'The first'</span>,P1 = <span class="string">'good'</span>,P2 = <span class="number">0</span>,P3 = <span class="number">2</span>)</span><br><span class="line">p.save()</span><br><span class="line"></span><br><span class="line"><span class="comment">#方法二insert</span></span><br><span class="line">p_id = Material.insert(&#123;</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'The second'</span>,</span><br><span class="line">    <span class="string">'P1'</span> :<span class="string">'good'</span>,</span><br><span class="line">    <span class="string">'P2'</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="string">'P3'</span> : <span class="number">2</span></span><br><span class="line">&#125;).execute()</span><br><span class="line"><span class="comment">#打印出新插入数据的id</span></span><br><span class="line">print(p_id)</span><br><span class="line"></span><br><span class="line"><span class="comment">#插入很多数据，性能最好的是使用insert_many()</span></span><br><span class="line">NUM = <span class="number">10000</span></span><br><span class="line">data = [&#123;</span><br><span class="line">            <span class="string">'name'</span>: <span class="string">'123'</span></span><br><span class="line">        &#125; <span class="keyword">for</span> i <span class="keyword">in</span> range(NUM)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> database.atomic():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, NUM, <span class="number">100</span>):</span><br><span class="line">        <span class="comment"># 每次批量插入100条，分成多次插入</span></span><br><span class="line">        Material.insert_many(data[i:i + <span class="number">100</span>]).execute()</span><br></pre></td></tr></table></figure>
<h4 id="删除"><a class="markdownIt-Anchor" href="#删除"></a> 删除：</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用delete().where().execute()进行删除，where()是条件，execute()负责执行语句。若是已经查询出来的实例，则直接使用delete_instance()删除。</span></span><br><span class="line">Material.delete().where(Material.name == <span class="string">'A'</span>).execute()</span><br><span class="line"></span><br><span class="line">已经实例化的数据（有id了）, 使用delete_instance</span><br><span class="line"></span><br><span class="line">p.id = <span class="number">1</span></span><br><span class="line">p.save()</span><br><span class="line">p.delete_instance()</span><br></pre></td></tr></table></figure>
<h4 id="修改"><a class="markdownIt-Anchor" href="#修改"></a> 修改</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##已经实例化的数据,指定了id这个primary key,则此时保存就是更新数据</span></span><br><span class="line"></span><br><span class="line">p = Material(name = <span class="string">'New_name'</span>,P1 = <span class="string">'new'</span>,P2 = <span class="number">0</span>,P3 = <span class="number">2</span>)</span><br><span class="line">p.id = <span class="number">1</span></span><br><span class="line">p.save()</span><br></pre></td></tr></table></figure>
<h4 id="查询"><a class="markdownIt-Anchor" href="#查询"></a> 查询</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查询单条数据</span></span><br><span class="line">p = Material.get(Material.id == <span class="number">1</span>)</span><br><span class="line">print(p.name, p.P1, p.P2,p.P3)</span><br><span class="line"><span class="comment">#使用where().get()查询</span></span><br><span class="line">p = Material.select().where(Material.name ==<span class="string">'The first'</span>).get()</span><br><span class="line">print(p.name, p.P1, p.P2,p.P3)</span><br><span class="line"><span class="comment">#查询多条数据</span></span><br><span class="line">persons = Material.select().where(Material.P2 ==<span class="number">0</span> ).get()</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> Material:</span><br><span class="line">    print(p.name, p.P1, p.P2,p.P3)</span><br></pre></td></tr></table></figure>
<h4 id="统计-排序-limit"><a class="markdownIt-Anchor" href="#统计-排序-limit"></a> 统计、排序、limit</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询整张表的数据条数</span></span><br><span class="line">total_num = Material.select().count()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询name为liuchungui的Person数量, 返回数量为1</span></span><br><span class="line">num = Person.select().where(Person.name == <span class="string">'liuchungui'</span>).count()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按照P3大小排序</span></span><br><span class="line">Materials = Material.select().order_by(Material.P3.desc())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按照创建时间升序排序</span></span><br><span class="line">persons = Person.select().order_by(Person.create_time.asc())</span><br></pre></td></tr></table></figure>
<h4 id="查询符"><a class="markdownIt-Anchor" href="#查询符"></a> 查询符</h4>
<p>其中，==、&lt;、&lt;=、&gt;、&gt;=、!=是很容易理解的，重点提下<code>&lt;&lt;</code>、<code>&gt;&gt;</code>和<code>%</code>。用示例说明：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &lt;&lt;使用，查询省份属于湖北和湖南的，对应sql语句：select * from person where province in ('湖南', '湖北')</span></span><br><span class="line">persons = Person.select().where(Person.province &lt;&lt; [<span class="string">'湖南'</span>, <span class="string">'湖北'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># &gt;&gt;使用，查询省份为空的，sql语句: select * from person where province is Null</span></span><br><span class="line">persons = Person.select().where(Person.province &gt;&gt; <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># %使用，查询省份中含有 湖 字，sql语句：select * from person where province like '%湖%'</span></span><br><span class="line">persons = Person.select().where(Person.province % <span class="string">'%湖%'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询湖南和湖北的, 注意需要用()将Person.province == '湖南'包一层</span></span><br><span class="line">persons = Person.select().where((Person.province == <span class="string">'湖南'</span>) | (Person.province == <span class="string">'湖北'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询湖南和身高1.75</span></span><br><span class="line">persons = Person.select().where((Person.province == <span class="string">'湖南'</span>) &amp; (Person.height == <span class="number">1.75</span>))</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/31/Python%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0%E8%B7%AF%E5%BE%84%E6%80%BB%E7%BB%93%20/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/31/Python%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0%E8%B7%AF%E5%BE%84%E6%80%BB%E7%BB%93%20/" itemprop="url">Python数据库学习路径总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-31T10:49:11+08:00">
                2020-05-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%88%91%E7%9A%84%E5%B0%8F%E7%A7%91%E7%A0%94/" itemprop="url" rel="index">
                    <span itemprop="name">我的小科研</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  1.3k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="写在前面">写在前面</h3>
<p>用Python做项目的时候经常会遇到管理数据的需求。常见的方式是用文件保存数据，还有 <strong>pickle</strong>、<strong>csv</strong> 等模块辅助。但对于稍微复杂一点的数据，往往不够方便。成熟的解决方案就是使用<strong>数据库</strong>。</p>
<p>本文我将收集一下学习Python数据库所涉及到的一些基本概念和学习路径，选择一条最适合我需求的路径。</p>
<h3 id="方式一学习sql语言使用mysql数据库或sqlite并使用pymysql库用python操作数据库">方式一：学习SQL语言，使用MySQL数据库（或Sqlite），并使用PyMySQL库用Python操作数据库。</h3>
<p>提到数据库，首先想到的自然是大名鼎鼎的数据库SQL语句，在正经的开发中应用很多。使用数据库的 <strong>SQL 语句</strong>几乎相当于再学一种新的语言。虽然 <strong>sqlite</strong>、<strong>pymysql</strong> 等模块提供了与数据的连接，但仍然需要自己去拼接 SQL 语句。</p>
<h4 id="sql语言">SQL语言</h4>
<blockquote>
<p>结构化查询语言(Structured Query Language)简称SQL，是一种特殊目的的编程语言，是一种数据库查询和设计语言，用于存取数据以及查询、更新和管理关系数据库系统.</p>
</blockquote>
<p>简而言之，SQL就是一种脚本编程语言，是绝大多数数据库（例如MYSQL、Oracle）的通用语言。</p>
<ul>
<li>SQL 面向数据库执行查询</li>
<li>SQL 可在数据库中插入新的记录</li>
<li>SQL 可更新数据库中的数据</li>
<li>SQL 可从数据库删除记录</li>
<li>SQL 可在数据库中创建新表</li>
<li>SQL 可在数据库中创建视图</li>
</ul>
<h4 id="数据库软件mysqlsqlite...">数据库软件：MySQL/Sqlite...</h4>
<p>MySQL是在90年代中期开发的数据库软件，是市场上第一个可用的开源数据库之一。MySQL是一种RDBMS，它允许保持数据库中存在的数据。MySQL适用SQL结构化查询语言用于访问，更新和操作数据库中的数据。</p>
<p>对于数据量较小，访问量较小的需求，甚至都不需要能承受高并发访问的大内存MySQL，可以只用SQLite，它的特点是轻量级、可嵌入，但不能承受高并发访问，适合桌面和移动应用。Python就内置了SQLite3，所以，在Python中使用SQLite，不需要安装任何东西，直接使用。</p>
<p>由于Python的准数据库接口DB-API定义都是通用的，所以，操作不同数据库的代码和方式都类似。</p>
<h4 id="pymysql">PyMySQL</h4>
<p>PyMySQL是在 Python3.x 版本中用于连接 MySQL 服务器的一个库。</p>
<h4 id="与python自带库pandas对比">与Python自带库Pandas对比</h4>
<p>Pandas是Python领域强大的数据处理与分析的类库，与SQL类似，两者都是对“表格型”数据的操作和查询，所以很多语法都能对应起来，例如<strong>SELECT数据查询，WHERE按条件查询，in和not in的条件查询，groupby分组统计，JOIN数据关联，UNION数据合并，Order Limit先排序后分页，取每个分组group的top n，UPDATE数据更新，DELETE删除数据</strong> ...</p>
<h3 id="方式二用orm方法操作轻量级数据库学习peewee库">方式二：用ORM方法操作轻量级数据库，学习peewee库</h3>
<p>学习SQL语句的时间成本通常很高，原生 SQL 的过程非常繁琐，代码重复，没有面向对象思维，在实际开发中，如无特殊需求，一般不会直接写 SQL，而是用更为方便的 <strong>ORM（对象关系映射，Object Relational Mapping）</strong>框架。ORM是将<strong>关系型数据库</strong>与 Python 中的<strong>对象</strong>关联起来，提供了一种操作数据的简便方式，相当于对数据库加了一层更友好的接口，有了 ORM 不再需要写 SQL 语句。同时兼容多种数据库系统，如sqlite, mysql、postgresql，付出的代价可能就是性能上的一些损失。</p>
<p>目前 Python 中比较流行的 ORM 解决方案有三种：<strong>Django ORM</strong>（使用方便，但很难脱离 Django 单独使用。）<strong>SQLAlchemy</strong>（功能强大，成熟可扩展，但学习门槛较高。）<strong>peewee</strong>（轻量，可扩展，易学习，但功能有限。）对于偏初级的小型项目，通常用不到很复杂的功能，就可以选择peewee库。</p>
<h4 id="peewee">peewee</h4>
<p>学习peewee的官方文档：http://docs.peewee-orm.com/en/latest/index.html</p>
<h3 id="方式三使用非关系型数据库">方式三：使用非关系型数据库</h3>
<p>对于数据存储还有一种解决方案，就是使用非关系型数据库。</p>
<p>以上提到的都是关系型数据库，虽然很好，但是随着互联网大规模的爆发，弱点也越来越明显，比如事务的一致性，多表联查，高并发等等瓶颈很明显。于是<strong>NoSQL</strong>一词横空出世，数据结构由键值(key=&gt;value)对组成，结构不固定，每一个元组可以有不一样的字段，每个元组可以根据需要增加一些自己的键值对，这样就不会局限于固定的结构，可以减少一些时间和空间的开销。</p>
<p>比如<strong>MongoDb</strong>就是典型的NoSQL型数据库。MongoD是非关系型数据库，也叫<strong>文档型数据库</strong>（即可以存放xml、json、bson类型的数据），是一种NoSQL的数据库。对于简单的数据存储来说，它有个巨大的优势就是<strong>同 Python 内置的 dict、list 等类型兼容良好</strong>，可以直接存取，让你甚至感觉不到有数据库的存在，也根本无需关心 SQL 语句。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/18/%E7%AE%A1%E9%81%93%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/18/%E7%AE%A1%E9%81%93%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%88%86%E6%9E%90/" itemprop="url">管道可靠性分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-18T10:49:11+08:00">
                2020-05-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%88%91%E7%9A%84%E5%B0%8F%E7%A7%91%E7%A0%94/" itemprop="url" rel="index">
                    <span itemprop="name">我的小科研</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  1.3k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="论文1">论文1</h3>
<p><strong><em>Alimi L, Chaoui K. Reliability Study of HDPE Pipe Using Slow Crack Growth Model[J].</em></strong></p>
<h4 id="概述">概述</h4>
<p>现在有多种预测HDPE寿命模型，彼此之间没有很大的共识，有些特定的参数也不是非常确切。尽管塑料管材标准及其相关的实验室测试也规定了超过50年的安全结构使用寿命，但是可靠性方法仍然是评估剩余结构寿命的一种安全方法。</p>
<p>这项研究涉及基于寿命估计模型的高密度聚乙烯（HDPE）管可靠性计算。用慢速裂纹扩展（SCG）模型与极限状态函数结合以获得表示失效概率的可靠性指标（β）。与钢质管道相比，塑料管道在此问题上的投入很少。</p>
<h4 id="顺序">顺序</h4>
<ul>
<li><p>物理模型搭建：</p>
<p>借鉴P.Hutar的文章用Paris公式解释SCG动力学特征</p>
<p><img src="/2020/05/18/%E7%AE%A1%E9%81%93%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%88%86%E6%9E%90/屏幕快照%202020-05-17%20下午11.50.54.png"></p></li>
<li><p>可靠性分析</p>
<ul>
<li>定义结构的性能函数（极限函数），用<span class="math inline">\(G(X_j)\)</span>表示，<span class="math inline">\(X_j\)</span>是随机变量。这个方程说明了安全裕度，该裕度由管道商推荐寿命（通常大于50年）和实际计算的寿命之间的差定义。即<span class="math inline">\(G=t_R-t_f\)</span></li>
<li>失效概率<span class="math inline">\(P_f=P[G(X)&lt;=0]=\phi(-\beta)\)</span> 中，<span class="math inline">\(P[G(X)&lt;=0]\)</span> 是概率算子，<span class="math inline">\(\phi(-\beta)\)</span>是累积高斯概率函数，<span class="math inline">\(\beta\)</span>是可靠性指标。</li>
<li><span class="math inline">\(P[G(X)&lt;=0]\)</span> 可以由基于FORM/SORM有限元计算的<span class="math inline">\(PHIMECA\)</span>软件计算得出。</li>
</ul></li>
<li><p>对各变量对应的可靠性指数<span class="math inline">\(\beta\)</span> 进行分别分析，作图，找安全范围</p>
<ul>
<li>随裂纹长度的变化</li>
</ul>
<p><img src="/2020/05/18/%E7%AE%A1%E9%81%93%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%88%86%E6%9E%90/屏幕快照%202020-05-18%20上午10.48.28.png"></p>
<ul>
<li>材料指数<span class="math inline">\(m\)</span></li>
</ul>
<p><img src="/2020/05/18/%E7%AE%A1%E9%81%93%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%88%86%E6%9E%90/屏幕快照%202020-05-18%20上午10.48.34.png"></p>
<ul>
<li>随施加应力</li>
</ul>
<p><img src="/2020/05/18/%E7%AE%A1%E9%81%93%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%88%86%E6%9E%90/屏幕快照%202020-05-18%20上午10.48.43.png"></p></li>
<li><p>结论</p>
<ul>
<li>基于SCG的塑料管的可靠性随着裂纹长度，压力和指数m的增加而降低</li>
<li>可以得出不同壁厚的某种管材，在一定的初始裂纹下，承受压力的安全范围</li>
</ul></li>
</ul>
<hr>
<h3 id="论文3">论文3</h3>
<p><strong>Alimi L, Chaoui K, Amirat A, et al. Study of reliability index for high-density polyethylene based on pipe standard dimension ratio and fracture toughness limits[J]. The International Journal of Advanced Manufacturing Technology, 2018, 96(1-4): 123-136.</strong>*</p>
<p>评论：与上一篇文章类似，把失效概率中的概率算子的变量换成了<span class="math inline">\(K_I\)</span>，即安全裕度由材料的临界断裂韧度<span class="math inline">\(K_Ic\)</span>与实际值之间的差异定义。模拟了可靠性指数<span class="math inline">\(\beta\)</span>对工作压力、裂纹长度和SDR三个参数的函数。</p>
<p>以上两篇文章在进行可靠性分析时都用到了phimeca软件，再来介绍一下这款软件</p>
<hr>
<h3 id="论文3-1">论文3</h3>
<p><strong><em>Lemaire, Maurice, and Maurice Pendola. Phimeca-soft.&quot;Structural safety 28.1-2 (2006): 130-149.</em></strong></p>
<p>该软件基于<em>FORM/SORM</em>可靠性计算，原理如下图</p>
<p><img src="/2020/05/18/%E7%AE%A1%E9%81%93%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%88%86%E6%9E%90/1-s2.0-S0167473005000196-gr1.jpg"></p>
<p>接下来用一个应用例子来介绍它：</p>
<h5 id="背景">背景</h5>
<p>排气歧管在损坏和漏气之前的寿命取决于几个参数：几何形状，与发动机的组装、材料特性、温度以及机械负载条件。制造过程和客户的多样性在这些参数值中引入了很大的可变性，影响了排气歧管的故障风险。</p>
<p>传统上，在寿命评估或结构抗力的合理性中不考虑这些可变性的来源。这项工作的目的是<strong>将这种不确定性引入歧管的预测行为模型中</strong>，以便通过使用形式方法的“可靠性指标”计算来确定失效的可能性。</p>
<h5 id="歧管介绍">歧管介绍</h5>
<p>歧管承受热负荷和机械负荷。我们使用具有大约200,000个节点的有限元模型并执行耦合的非线性热力和机械分析来模拟歧管的结构行为。由此分析可以得出有关整个结构的应力和温度的变化情况。</p>
<h5 id="引入随机量">引入随机量</h5>
<p>不确定的参数涉及：</p>
<ul>
<li><p>在最大和最小发动机功率下废气的温度<span class="math inline">\(T_\max\)</span>和<span class="math inline">\(T_\min\)</span>，两个温度都会影响一个循环中的热和机械性能。</p></li>
<li>用于制造歧管的内核位置：由于制造过程<span class="math inline">\(dx,dy,dz\)</span> ，该位置在三个方向上独立变化。这会导致厚度过大或过低，从而可能重新分配整个结构的热和机械负载。</li>
<li><p>材料特性（杨氏模量<em>ë</em>，屈服应力<em>σ</em> <em>ÿ</em>和从推导出极限强度<em>σ</em> <em>ý</em>取决于温度以及用于寿命的估计疲劳性能的损坏系数考虑恒定塑料模量）</p></li>
</ul>
<p>已经确定了在特定温度下材料性能的平均值和标准偏差。为了获得每个温度下的随机性，物理随机变量的实现定义为</p>
<p><span class="math inline">\(x(T)=mx(T)+u_X\sigma_X(T)\)</span></p>
<p>将包含相关性的九个随机变量引入有限元模型和预测的循环数中。</p>
<h5 id="结果">结果</h5>
<p>用PHIMECA进行计算后，对于所有上述可变性源，获得的故障概率为1.3％，对应可靠性指标<em>β</em> 为2.24。换句话说，在考虑了机械模型并引入了可变性之后，有1.3％的测试歧管将无法通过严格性测试。同时，如下图，phimeca-soft还给出的重要性因子，确定所有随机变量的影响力，决定应该改进的部分</p>
<p><img src="/2020/05/18/%E7%AE%A1%E9%81%93%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%88%86%E6%9E%90/1-s2.0-S0167473005000196-gr10.jpg"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%99%BA%E8%83%BD%E6%B1%BD%E8%BD%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%99%BA%E8%83%BD%E6%B1%BD%E8%BD%A6/" itemprop="url">基于人工智能的汽车智能故障诊断系统设计</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-16T23:41:41+08:00">
                2020-05-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%99%BA%E8%83%BD%E5%8C%96/" itemprop="url" rel="index">
                    <span itemprop="name">智能化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  5.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="项目背景及意义"><a href="#项目背景及意义" class="headerlink" title="项目背景及意义"></a><strong>项目背景及意义</strong></h3><p>“智能+工业”不仅是我国的一个发展战略需求，也是人工智能的热门应用方向之一。智能汽车是一种新型高科技汽车，借助人工智能实现用车保养和零件检测的自动化将会极高地提升车辆的安全程度。除了自动驾驶等智能汽车技术外，特斯拉、宝马等企业正还准备使用人工智能升级以往的车辆故障检测系统，希望实现自动寻找检测汽车某些部件的损坏情况，以便在潜在故障发生之前就对车辆进行检测和维修，甚至在发现问题之后，配合自动驾驶系统让车辆自行驾驶至服务中心。</p>
<p>本文中我们将采用使用人工智能的方法构建一套模型，通过智能汽车内零部件传感器的数据，运用机器学习进行建模分析，构建一套汽车智能故障诊断系统，从而帮助车厂判断汽车的健康状况。</p>
<h3 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a><strong>相关概念</strong></h3><h4 id="汽车传感器：智能汽车的感知和计算"><a href="#汽车传感器：智能汽车的感知和计算" class="headerlink" title="汽车传感器：智能汽车的感知和计算"></a>汽车传感器：智能汽车的感知和计算</h4><p>传感器是一种检测装置，能够感受到被测量的信息，并能将感受到的信息按照一定规律转变为电信号或其他所需形式的信息输出，满足信息的传输、处理、存储、显示、记录和控制等要求。汽车传感器可分为车辆感知、环境感知两大类。动力、底盘、车身及电子电气系统中的传感器属于车辆感知范畴，ADAS 以及无人驾驶系统中引入的车载摄像头、毫米波雷达、激光雷达等属于环境感知范畴。传感器作为智能汽车感知环境的硬件基础，在智能驾驶发展过程中起着重要作用<a href="#_edn1">[i]</a>。</p>
<p><img src="/2020/05/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%99%BA%E8%83%BD%E6%B1%BD%E8%BD%A6/图片 1.png" alt="智能汽车传感系统"></p>
<p>本项目中，我们可以借助车辆感知大类的传感器收集汽车运行中的各种工况信息，如车速、各种介质的温度、发动机运转工况、各部位压力等。将他们转化成电讯号输给计算机，远程分析车辆的健康状况。</p>
<h4 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a><strong>机器学习</strong></h4><p>机器学习是一门涉及多领域的交叉学科，其研究内容涉及概率论，统计学，算法复杂度，线性代数，微积分等众多领域。机器学习研究的是计算机如何模拟人类的学习行为，从相应的数据中学习到一定的规律，并能够对新的数据进行分析。目前十分火热的深度学习就是机器学习的一个分支，机器学习在众多现代计算机 领域有着十分重要的作用，比如图像处理，语音识别，自然语言处理等等。机器学习分监督学习，无监督学习，半监督学习。使用机器学习可以对数据进行分类，回归等等分析。常用的机器学习算法有:线性回归，逻辑斯蒂回归，cart 决策树，随机森林，Adaboosting，bagging，SVM，k-means，PCA等等算法。本文将通过集成学习的方法，同时根据实际业务问题调整阈值，对车辆传感器的数据进行分析，确保将健康状况不良好的汽车即使召回。</p>
<h3 id="汽车传感器数据分析"><a href="#汽车传感器数据分析" class="headerlink" title="汽车传感器数据分析"></a><strong>汽车传感器数据分析</strong></h3><h4 id="数据探索和方法选择"><a href="#数据探索和方法选择" class="headerlink" title="数据探索和方法选择"></a>数据探索和方法选择</h4><p>我手上的训练集共有60000条训练样本，测试集共有16000条训练样本。每个数据一共有171个特征，由于数据提供方的原因，数据的特征是匿名的。其中有的特征是数值连续特征，有的特征是对数据特征进行了histograms处理。缺失数据表示为NaN。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 导入依赖库</span><br><span class="line">from matplotlib import pyplot as plt</span><br><span class="line">%matplotlib inline</span><br><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">import warnings</span><br><span class="line">warnings.filterwarnings(&quot;ignore&quot;)</span><br><span class="line">#加载数据</span><br><span class="line">train &#x3D; pd.read_csv(&#39;train_set.csv&#39;,na_values&#x3D;&#39;na&#39;)</span><br><span class="line">test &#x3D; pd.read_csv(&#39;test_set.csv&#39;,na_values&#x3D;&#39;na&#39;)</span><br><span class="line">#查看数据的shape</span><br><span class="line">print(&#39;训练集的形状：&#123;&#125;&#39;.format(train.shape))</span><br><span class="line">print(&#39;测试集的形状：&#123;&#125;&#39;.format(test.shape))</span><br><span class="line"></span><br><span class="line"># TODO：打印train前五行数据</span><br><span class="line">train.head()</span><br><span class="line"># TODO：打印test前五行数据</span><br><span class="line">test.head()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%99%BA%E8%83%BD%E6%B1%BD%E8%BD%A6/2.png" alt="前5行数据的部分特征"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># TODO：查看train数据中class这列的类别比例</span><br><span class="line">pd.value_counts(train[&#39;class&#39;])</span><br></pre></td></tr></table></figure>
<p>通过查看数据类别，我发现训练集共60000个样本中，有59000条是正常样本，只有1000条是故障车辆样本。此问题是一个典型的样本不均衡问题，对于这种非常不均衡的问题一般有两种解决思路：</p>
<p>（1）使用异常值检测的方法：将少类的样本看作异常值</p>
<p>（2）使用监督学习的方法，看作分类问题。</p>
<p>本文中我将使用监督学习的方法来对他们进行建模。</p>
<h4 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h4><p>对于传感器的原始数据数据，我按顺序进行以下预处理: </p>
<h5 id="区分特征值和标签"><a href="#区分特征值和标签" class="headerlink" title="区分特征值和标签"></a>区分特征值和标签</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 将特征和标签划分开</span><br><span class="line"># 在这一步中我们将把feature和label分开</span><br><span class="line">train_feature  &#x3D; train[train.columns.difference([&#39;class&#39;])]</span><br><span class="line">train_label &#x3D; train[&#39;class&#39;]</span><br><span class="line"></span><br><span class="line">test_feature  &#x3D; test[test.columns.difference([&#39;class&#39;])]</span><br><span class="line">test_label &#x3D; test[&#39;class&#39;]</span><br></pre></td></tr></table></figure>
<h5 id="区分数据特征类型："><a href="#区分数据特征类型：" class="headerlink" title="区分数据特征类型："></a>区分数据特征类型：</h5><p>如前文所述，传感器数据分为两类，一类是数值特征，一类是通过直方图得到的分布特征。由于直方图类数据在特征选择时要进行特殊的处理，因此第一步是通过通过正则表达式，自动匹配这类分布特征的字段类型，进行查找和筛选。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">pattern &#x3D; re.compile(&#39;[a-z]*_001&#39;)</span><br><span class="line">col_bin_name &#x3D; [re.findall(pattern,char) for char in train_feature.columns.tolist() if len(re.findall(pattern,char))!&#x3D;0]</span><br><span class="line">bin_name_lst &#x3D; []</span><br><span class="line">for col in col_bin_name:</span><br><span class="line">    pattern &#x3D; re.compile(col[0][:2]+&#39;_[0-9]*&#39;)</span><br><span class="line">    find_name &#x3D; [re.findall(pattern,char) for char in train_feature.columns.tolist() if len(re.findall(pattern,char))!&#x3D;0]</span><br><span class="line">    bin_name_lst.append(np.concatenate(find_name,axis&#x3D;0))</span><br><span class="line">    print(find_name)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%99%BA%E8%83%BD%E6%B1%BD%E8%BD%A6/3.png" alt="打印出所有直方图类的特征"></p>
<h5 id="标签数据转换："><a href="#标签数据转换：" class="headerlink" title="标签数据转换："></a>标签数据转换：</h5><p>neg意味着汽车的健康状况为良好，不需要检修；pos为状况不良，需要检修。为了便于计算，我将neg标签转换为0，pos标签转换为1。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">train_label &#x3D; train_label.map(&#123;&#39;pos&#39;:1,&#39;neg&#39;:0&#125;)</span><br><span class="line">test_label &#x3D; test_label.map(&#123;&#39;pos&#39;:1,&#39;neg&#39;:0&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="数据缺失值填充："><a href="#数据缺失值填充：" class="headerlink" title="数据缺失值填充："></a>数据缺失值填充：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># TODO：统计训练集和测试集分别有多少行有缺失</span><br><span class="line">print(&#39;训练集缺失&#39;,(train.isnull().sum(axis&#x3D;1)&gt;0).sum(),&#39;行&#39;)</span><br><span class="line">print(&#39;训练集缺失&#39;,(train.isnull().sum(axis&#x3D;0)&gt;0).sum(),&#39;列&#39;)</span><br><span class="line"># TODO：统计训练集和测试集分别有多少列有缺失</span><br><span class="line">print(&#39;测试集缺失&#39;,(test.isna().sum(axis&#x3D;1)&gt;0).sum(),&#39;行&#39;)</span><br><span class="line">print(&#39;测试集缺失&#39;,(test.isnull().sum(axis&#x3D;0)&gt;0).sum(),&#39;列&#39;)</span><br></pre></td></tr></table></figure>
<p>对数据进行缺失值的分析，发现训练集共缺失 59409 行，169 列；测试集缺失 15835 行，169 列。可以判断有大量的缺失值，因此不能进行简单地丢弃，而是需要进行填充。填充的方法有均值填充和模型填充。在计算效果上，模型填充更优，但计算量较大。此处我们使用均值填充。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 使用训练集的均值进行填充</span><br><span class="line">for col in train_feature.columns:</span><br><span class="line">    train_feature[col] &#x3D; train_feature[col].fillna(train_feature[col].mean())</span><br><span class="line"></span><br><span class="line">for col in test_feature.columns:</span><br><span class="line">    test_feature[col] &#x3D; test_feature[col].fillna(train_feature[col].mean())</span><br></pre></td></tr></table></figure>
<h5 id="特征工程："><a href="#特征工程：" class="headerlink" title="特征工程："></a>特征工程：</h5><p>虽然大部分的数据都只有匿名的特征，但仍然可以对直方图特征做一些特征的抽取工作。对于直方图特征，可以想象，每个直方图的bins的和表示了这个车辆检查这个特征的次数，那么显然这个数字的和越大就代表这个车子检查这个特征的次数越多，也间接的表明了这个车子到目前为止的使用寿命；直方图表示了这个特征的分布，可以通过JS散度和推土机距离来度量分布之间的距离来成为一个新的特征。因此本项目中，我选择以下几种基准分布：</p>
<p>（1）正样本的每个直方图特征的均值分布。</p>
<p>（2）负样本的每个直方图特征的均值分布。</p>
<p>（3）一个正态分布。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">## 特征抽取一：</span><br><span class="line">train_feature_extract &#x3D; pd.DataFrame(index&#x3D;train_feature.index)</span><br><span class="line">for index,col in enumerate(col_bin_name):</span><br><span class="line">    pattern &#x3D; re.compile(col[0][:2]+&#39;_[0-9]*&#39;)</span><br><span class="line">    find_name &#x3D; [re.findall(pattern,char) for char in train_feature.columns.tolist() if len(re.findall(pattern,char))!&#x3D;0]</span><br><span class="line">    name &#x3D; &#39;sum_bins_&#39;+str(index)</span><br><span class="line">    train_feature_extract[name] &#x3D; train_feature[np.concatenate(find_name,axis&#x3D;0)].sum(axis&#x3D;1)</span><br><span class="line">train_feature_extract[&#39;bins_max&#39;] &#x3D; train_feature_extract.max(axis&#x3D;1)</span><br><span class="line"></span><br><span class="line">test_feature_extract &#x3D; pd.DataFrame(index&#x3D;test_feature.index)</span><br><span class="line">for index,col in enumerate(col_bin_name):</span><br><span class="line">    pattern &#x3D; re.compile(col[0][:2]+&#39;_[0-9]*&#39;)</span><br><span class="line">    find_name &#x3D; [re.findall(pattern,char) for char in test_feature.columns.tolist() if len(re.findall(pattern,char))!&#x3D;0]</span><br><span class="line">    name &#x3D; &#39;sum_bins_&#39;+str(index)</span><br><span class="line">    test_feature_extract[name] &#x3D; test_feature[np.concatenate(find_name,axis&#x3D;0)].sum(axis&#x3D;1)</span><br><span class="line">test_feature_extract[&#39;bins_max&#39;] &#x3D; test_feature_extract.max(axis&#x3D;1)</span><br><span class="line"></span><br><span class="line">## 把特征分为数值特征和直方图特征两部分</span><br><span class="line">train_num_feature &#x3D; train_feature[train_feature.columns.difference(np.concatenate(bin_name_lst,axis&#x3D;0))];</span><br><span class="line">train_bin_feature &#x3D; train_feature[np.concatenate(bin_name_lst,axis&#x3D;0)];</span><br><span class="line"></span><br><span class="line">test_num_feature &#x3D; test_feature[test_feature.columns.difference(np.concatenate(bin_name_lst,axis&#x3D;0))];</span><br><span class="line">test_bin_feature &#x3D; test_feature[np.concatenate(bin_name_lst,axis&#x3D;0)];</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">## 特征抽取二：</span><br><span class="line">## 生成基准分布</span><br><span class="line">from matplotlib import pyplot as plt</span><br><span class="line"># pos均匀分布</span><br><span class="line"># neg均匀分布</span><br><span class="line">pos_distribution_mean &#x3D; []</span><br><span class="line">neg_distribution_mean &#x3D; []</span><br><span class="line">for index,col in enumerate(col_bin_name):</span><br><span class="line">    pattern &#x3D; re.compile(col[0][:2]+&#39;_[0-9]*&#39;)</span><br><span class="line">    find_name &#x3D; [re.findall(pattern,char) for char in train_feature.columns.tolist() if len(re.findall(pattern,char))!&#x3D;0]</span><br><span class="line">    pos &#x3D; train_bin_feature.iloc[train_label[train_label&#x3D;&#x3D;1].index.tolist()][np.concatenate(find_name,axis&#x3D;0)]</span><br><span class="line">    neg &#x3D; train_bin_feature.iloc[train_label[train_label&#x3D;&#x3D;0].index.tolist()][np.concatenate(find_name,axis&#x3D;0)]</span><br><span class="line">    pos_distribution_mean.append(pos.sum(axis&#x3D;0))</span><br><span class="line">    neg_distribution_mean.append(neg.sum(axis&#x3D;0))</span><br><span class="line"></span><br><span class="line"># 高斯分布</span><br><span class="line">gs_distribution_sample &#x3D; np.random.normal(loc&#x3D;5.0, scale&#x3D;1.5,size&#x3D;500000)</span><br><span class="line">gs_distribution &#x3D; plt.hist(gs_distribution_sample,bins&#x3D;10)[0]</span><br><span class="line"></span><br><span class="line"># 分布归一化</span><br><span class="line">pos_dis &#x3D; [pos&#x2F;pos.sum() for pos in pos_distribution_mean];</span><br><span class="line">neg_dis &#x3D; [neg&#x2F;neg.sum() for neg in neg_distribution_mean];</span><br><span class="line">gs_distribution &#x3D; gs_distribution&#x2F;gs_distribution.sum()</span><br><span class="line"></span><br><span class="line">## 定义wasserstein距离(推土机距离)和JS散度</span><br><span class="line">from scipy.stats import entropy</span><br><span class="line">from scipy.stats import wasserstein_distance</span><br><span class="line">def js_dis(x,q):</span><br><span class="line">    M&#x3D;(x+q)&#x2F;2</span><br><span class="line">    js2&#x3D;0.5*entropy(x, M)+0.5*entropy(q, M)</span><br><span class="line">    return js2</span><br><span class="line">def ws_dis(x,q):</span><br><span class="line">    return wasserstein_distance(x,q)</span><br><span class="line">    </span><br><span class="line">## 特征抽取二：</span><br><span class="line">## 没有tqdm的需要先安装tqdm这个包。</span><br><span class="line">## 这个步骤的计算时间非常长，请耐心等待。</span><br><span class="line">## 训练集的特征抽取</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">name_number &#x3D; 1</span><br><span class="line">for index,col in tqdm(enumerate(col_bin_name)):</span><br><span class="line">    pattern &#x3D; re.compile(col[0][:2]+&#39;_[0-9]*&#39;)</span><br><span class="line">    find_name &#x3D; [re.findall(pattern,char) for char in train_feature.columns.tolist() if len(re.findall(pattern,char))!&#x3D;0]</span><br><span class="line">    temp &#x3D; train_bin_feature[np.concatenate(find_name,axis&#x3D;0)]</span><br><span class="line">    temp &#x3D; temp.apply(lambda x:x&#x2F;x.sum(),axis&#x3D;1)</span><br><span class="line">    for pos in pos_dis:</span><br><span class="line">        train_feature_extract[name_number] &#x3D; temp.apply(js_dis,axis&#x3D;1,args&#x3D;(pos.values,))</span><br><span class="line">        name_number+&#x3D;1</span><br><span class="line">        train_feature_extract[name_number] &#x3D; temp.apply(ws_dis,axis&#x3D;1,args&#x3D;(pos.values,))</span><br><span class="line">        name_number+&#x3D;1</span><br><span class="line">    for neg in neg_dis:</span><br><span class="line">        train_feature_extract[name_number] &#x3D; temp.apply(js_dis,axis&#x3D;1,args&#x3D;(neg.values,))</span><br><span class="line">        name_number+&#x3D;1</span><br><span class="line">        train_feature_extract[name_number] &#x3D; temp.apply(ws_dis,axis&#x3D;1,args&#x3D;(neg.values,))</span><br><span class="line">        name_number+&#x3D;1</span><br><span class="line">    train_feature_extract[name_number] &#x3D; temp.apply(js_dis,axis&#x3D;1,args&#x3D;(gs_distribution,))</span><br><span class="line">    name_number+&#x3D;1</span><br><span class="line">    train_feature_extract[name_number] &#x3D; temp.apply(ws_dis,axis&#x3D;1,args&#x3D;(gs_distribution,))</span><br><span class="line">    name_number+&#x3D;1    </span><br><span class="line">## 测试集的特征抽取</span><br><span class="line">name_number &#x3D; 1</span><br><span class="line">for index,col in tqdm(enumerate(col_bin_name)):</span><br><span class="line">    pattern &#x3D; re.compile(col[0][:2]+&#39;_[0-9]*&#39;)</span><br><span class="line">    find_name &#x3D; [re.findall(pattern,char) for char in test_feature.columns.tolist() if len(re.findall(pattern,char))!&#x3D;0]</span><br><span class="line">    temp &#x3D; test_bin_feature[np.concatenate(find_name,axis&#x3D;0)]</span><br><span class="line">    temp &#x3D; temp.apply(lambda x:x&#x2F;x.sum(),axis&#x3D;1)</span><br><span class="line">    for pos in pos_dis:</span><br><span class="line">        test_feature_extract[name_number] &#x3D; temp.apply(js_dis,axis&#x3D;1,args&#x3D;(pos.values,))</span><br><span class="line">        name_number+&#x3D;1</span><br><span class="line">        test_feature_extract[name_number] &#x3D; temp.apply(ws_dis,axis&#x3D;1,args&#x3D;(pos.values,))</span><br><span class="line">        name_number+&#x3D;1</span><br><span class="line">    for neg in neg_dis:</span><br><span class="line">        test_feature_extract[name_number] &#x3D; temp.apply(js_dis,axis&#x3D;1,args&#x3D;(neg.values,))</span><br><span class="line">        name_number+&#x3D;1</span><br><span class="line">        test_feature_extract[name_number] &#x3D; temp.apply(ws_dis,axis&#x3D;1,args&#x3D;(neg.values,))</span><br><span class="line">        name_number+&#x3D;1</span><br><span class="line">    test_feature_extract[name_number] &#x3D; temp.apply(js_dis,axis&#x3D;1,args&#x3D;(gs_distribution,))</span><br><span class="line">    name_number+&#x3D;1</span><br><span class="line">    test_feature_extract[name_number] &#x3D; temp.apply(ws_dis,axis&#x3D;1,args&#x3D;(gs_distribution,))</span><br><span class="line">    name_number+&#x3D;1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">print(train_feature_extract.shape)</span><br><span class="line">print(test_feature_extract.shape)</span><br><span class="line">## 抽取完特征后，会发现部分特征是nan或者inf，这是由于在计算分布距离的时候有的分布是0导致的</span><br><span class="line">## 所以我们需要对抽取后的nan、inf这部分数据进行变换</span><br><span class="line"></span><br><span class="line">train_feature_extract &#x3D; train_feature_extract.fillna(-1)</span><br><span class="line">test_feature_extract &#x3D; test_feature_extract.fillna(-1)</span><br><span class="line"></span><br><span class="line">def f_inf(x):</span><br><span class="line">    if x&#x3D;&#x3D;np.inf:</span><br><span class="line">        return -2</span><br><span class="line">    else:</span><br><span class="line">        return x</span><br><span class="line">train_feature_extract &#x3D; train_feature_extract.applymap(f_inf)</span><br><span class="line">test_feature_extract &#x3D; test_feature_extract.applymap(f_inf)</span><br></pre></td></tr></table></figure>
<h4 id="模型设计和集成"><a href="#模型设计和集成" class="headerlink" title="模型设计和集成"></a>模型设计和集成</h4><p>处理好数据之后使用数据对模型进行训练模型，此处我选择了Logistic 回归、决策树和随机森林三个基础模型，并根据使用交叉验证和网格搜索选择合适的参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## 模型选择、交叉验证、网格搜索</span><br><span class="line">from sklearn.model_selection import GridSearchCV</span><br><span class="line">from sklearn.metrics import roc_auc_score, make_scorer</span><br><span class="line">from sklearn.linear_model import LogisticRegression</span><br><span class="line">#网格搜索：逻辑斯特回归</span><br><span class="line">param&#x3D;&#123; &#39;C&#39;:[0.0001,0.001,0.01,0.1,0.5,1.0]&#125;</span><br><span class="line">Grid2&#x3D;GridSearchCV(estimator&#x3D;LogisticRegression(),param_grid&#x3D;param,scoring&#x3D;make_scorer(roc_auc_score))</span><br><span class="line">Grid2.fit(train_feature_extract, train_label)</span><br><span class="line">print(f&quot;逻辑斯特回归交叉验证中测试的最优参数：&#123;Grid2.best_params_&#125;&quot;)</span><br><span class="line">print(f&quot;逻辑斯特回归交叉验证中AUC最高得分：&#123;Grid2.best_score_&#125;&quot;)</span><br><span class="line">best_model_lgr &#x3D; Grid2.best_estimator_</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#网格搜索：决策树</span><br><span class="line">from sklearn.tree import DecisionTreeClassifier</span><br><span class="line">parameters &#x3D; &#123;&#39;max_depth&#39;:[3, 5, 7, 9],&#39;min_samples_leaf&#39;: [1, 2, 3, 4]&#125;# 选择两个超参数 树的深度max_depth和叶子的最小值min_samples_leaf</span><br><span class="line">Grid1 &#x3D; GridSearchCV(estimator&#x3D;DecisionTreeClassifier(random_state&#x3D;0), param_grid&#x3D;parameters,scoring &#x3D; make_scorer(roc_auc_score),cv&#x3D;3)# 进行网格搜索得到最优参数组合</span><br><span class="line">Grid1.fit(train_feature_extract, train_label) #通过有最优参数组合的最优模型进行训练</span><br><span class="line">print(f&quot;决策树交叉验证中测试的最优参数：&#123;Grid1.best_params_&#125;&quot;)</span><br><span class="line">print(f&quot;决策树交叉验证中AUC最高得分：&#123;Grid1.best_score_&#125;&quot;)</span><br><span class="line">best_model_dtc &#x3D; Grid1.best_estimator_</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#随机森林很多内部变量的网格搜索</span><br><span class="line">from sklearn.svm import SVC</span><br><span class="line">from sklearn.ensemble import RandomForestClassifier</span><br><span class="line">#首先对n_estimators进行网格搜索：</span><br><span class="line">param_test1 &#x3D; &#123;&#39;n_estimators&#39;:[20,30,40,50]&#125;</span><br><span class="line">gsearch1 &#x3D; GridSearchCV(estimator &#x3D; RandomForestClassifier(min_samples_split&#x3D;100,</span><br><span class="line">                                  min_samples_leaf&#x3D;20,max_depth&#x3D;8,max_features&#x3D;&#39;sqrt&#39; ,random_state&#x3D;10), </span><br><span class="line">                       param_grid &#x3D; param_test1, scoring&#x3D;&#39;roc_auc&#39;,cv&#x3D;5)</span><br><span class="line">gsearch1.fit(train_feature_extract,train_label)</span><br><span class="line">print( gsearch1.best_params_, gsearch1.best_score_)#,gsearch1.cv_results_打印拟合结果)</span><br><span class="line">#接着对决策树最大深度max_depth进行网格搜索。</span><br><span class="line">param_test2 &#x3D; &#123;&#39;max_depth&#39;:[1,2,3,5,7,9,11,13]&#125;</span><br><span class="line">gsearch2 &#x3D; GridSearchCV(estimator &#x3D; RandomForestClassifier(n_estimators&#x3D;50, min_samples_split&#x3D;100,</span><br><span class="line">                                  min_samples_leaf&#x3D;20,max_features&#x3D;&#39;sqrt&#39; ,oob_score&#x3D;True, random_state&#x3D;10),</span><br><span class="line">param_grid &#x3D; param_test2, scoring&#x3D;&#39;roc_auc&#39;,iid&#x3D;False, cv&#x3D;5)</span><br><span class="line">gsearch2.fit(train_feature_extract,train_label)</span><br><span class="line">print( gsearch2.best_params_, gsearch2.best_score_)</span><br><span class="line">#得到max_depth&#x3D;5。</span><br><span class="line">#下面再对内部节点再划分所需最小样本数min_samples_split和叶子节点最少样本数min_samples_leaf一起调参。</span><br><span class="line">param_test3 &#x3D; &#123;&#39;min_samples_split&#39;:[80,100,150], &#39;min_samples_leaf&#39;:[10,20,50,100]&#125;</span><br><span class="line">gsearch3 &#x3D; GridSearchCV(estimator &#x3D; RandomForestClassifier(n_estimators&#x3D; 50, max_depth&#x3D;5,</span><br><span class="line">                                  max_features&#x3D;&#39;sqrt&#39; ,oob_score&#x3D;True, random_state&#x3D;10),</span><br><span class="line">   param_grid &#x3D; param_test3, scoring&#x3D;&#39;roc_auc&#39;,iid&#x3D;False, cv&#x3D;5)</span><br><span class="line">gsearch3.fit(train_feature_extract,train_label)</span><br><span class="line">print( gsearch3.best_params_, gsearch3.best_score_)</span><br><span class="line">#得到min_samples_split&#x3D;50和min_samples_leaf&#x3D;150</span><br><span class="line">#再对最大特征数max_features做调参:</span><br><span class="line">param_test4 &#x3D; &#123;&#39;max_features&#39;:[3,5,7,9,11]&#125;</span><br><span class="line">gsearch4 &#x3D; GridSearchCV(estimator &#x3D; RandomForestClassifier(n_estimators&#x3D; 50, max_depth&#x3D;5, min_samples_split&#x3D;150,</span><br><span class="line">                                  min_samples_leaf&#x3D;50 ,oob_score&#x3D;True, random_state&#x3D;10),</span><br><span class="line">   param_grid &#x3D; param_test4, scoring&#x3D;&#39;roc_auc&#39;,iid&#x3D;False, cv&#x3D;5)</span><br><span class="line">gsearch4.fit(train_feature_extract,train_label)</span><br><span class="line">print( gsearch4.best_params_, gsearch4.best_score_)</span><br><span class="line">#得到&#39;max_features&#39;&#x3D;9</span><br><span class="line">#用我们搜索到的最佳参数，我们再看看最终随机森林的模型拟合：</span><br><span class="line">rf2 &#x3D; RandomForestClassifier(n_estimators&#x3D; 50, max_depth&#x3D;5, min_samples_split&#x3D;150,</span><br><span class="line">                                  min_samples_leaf&#x3D;50,max_features&#x3D;9, oob_score&#x3D;True, random_state&#x3D;10)</span><br><span class="line">rf2.fit(train_feature_extract,train_label)</span><br><span class="line">best_model_rfc &#x3D; rf2</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.metrics import confusion_matrix</span><br><span class="line">from sklearn.metrics import roc_auc_score</span><br><span class="line">#测试集上结果</span><br><span class="line">print(f&quot;决策树测试集上的AUC是:&#123;roc_auc_score(test_label,best_model_dtc.predict(test_feature_extract))&#125;&quot;)</span><br><span class="line">print(f&quot;逻辑斯特回归测试集上的AUC是:&#123;roc_auc_score(test_label,best_model_lgr.predict(test_feature_extract))&#125;&quot;)</span><br><span class="line">print(f&quot;随机森林回归测试集上的AUC是:&#123;roc_auc_score(test_label, best_model_rfc.predict(test_feature_extract))&#125;&quot;)</span><br></pre></td></tr></table></figure>
<p>结果显示，在训练集上使用Logistic回归得到的AUC参数为0.606，决策树得到的AUC为0.644，略高于Logistic回归，通过随机森林得到的AUC为0.969。</p>
<p>验证集上的结果分别为：决策树AUC 0.744，逻辑斯特回归测试集上的AUC是:0.762，随机森林回归测试集上的AUC是:0.660。随机森林在训练集和测试集上差异大的原因可能是出现了过拟合。</p>
<p>除了直接查看AUC，还可以通过用AUC=0.5作为阈值看结果的混淆矩阵，同时设计一个随机猜测函数作为baseline来进一步查看模型相对于随机猜测时候的优势。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#查看以0.5作为阈值的混淆矩阵</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import seaborn as sns</span><br><span class="line">true&#x3D;test_label</span><br><span class="line">pred1&#x3D;Grid1.predict(test_feature_extract)</span><br><span class="line">pred2&#x3D;Grid2.predict(test_feature_extract)</span><br><span class="line">pred3&#x3D;best_model_rfc.predict(test_feature_extract)</span><br><span class="line">#导入混淆矩阵函数</span><br><span class="line">cm1&#x3D;confusion_matrix(true,pred1)</span><br><span class="line">cm2&#x3D;confusion_matrix(true,pred2)</span><br><span class="line">cm3&#x3D;confusion_matrix(true,pred3)</span><br><span class="line">#导入作图函数</span><br><span class="line">plt.matshow(cm1,cmap&#x3D;plt.cm.Greens)</span><br><span class="line">sns.heatmap(cm1,annot&#x3D;True)</span><br><span class="line">plt.matshow(cm2,cmap&#x3D;plt.cm.Greens)</span><br><span class="line">sns.heatmap(cm2,annot&#x3D;True)</span><br><span class="line">plt.matshow(cm3,cmap&#x3D;plt.cm.Greens)</span><br><span class="line">sns.heatmap(cm3,annot&#x3D;True)</span><br><span class="line">#输出为混淆矩阵</span><br><span class="line">#TODO：随机猜测函数</span><br><span class="line">random&#x3D; np.random.randint(0,2,16000)</span><br><span class="line">cm0&#x3D;confusion_matrix(true,random)</span><br><span class="line">plt.matshow(cm0,cmap&#x3D;plt.cm.Greens)</span><br><span class="line">sns.heatmap(cm0,annot&#x3D;True)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%99%BA%E8%83%BD%E6%B1%BD%E8%BD%A6/屏幕快照 2020-05-16 下午11.45.35.png" alt="混淆矩阵:左上（决策树）右上（Logistic）左下（随机森林）右下（随机猜测）"></p>
<p>在训练完单个模型之后，我们将进行模型的集成。集成技术是将多个分类器的结果或性能结合起来，以提高单个分类器的性能。该方法通过装配不同的分类器来修改单个分类器的归纳能力<a href="#_edn2">[ii]</a>，也能更好地解决样本不均衡的问题。此处，我们使用stacking的方法对步骤四生成的不同学习器进行集成，同时画出集成后模型的ROC曲线。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">## TODO:模型集成</span><br><span class="line">from mlxtend.classifier import EnsembleVoteClassifier</span><br><span class="line">from mlxtend.data import iris_data</span><br><span class="line">clf1&#x3D;best_model_dtc</span><br><span class="line">clf2&#x3D;best_model_lgr</span><br><span class="line">clf3&#x3D;best_model_rfc</span><br><span class="line">eclf&#x3D;EnsembleVoteClassifier(clfs&#x3D;[clf1, clf2,clf3],</span><br><span class="line">                              weights&#x3D;[2,1,1], voting&#x3D;&#39;soft&#39;)</span><br><span class="line">eclf.fit(train_feature_extract,train_label)</span><br><span class="line">## TODO：ROC曲线</span><br><span class="line"></span><br><span class="line">from sklearn.metrics import roc_curve, auc</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">from sklearn.model_selection import StratifiedKFold</span><br><span class="line"></span><br><span class="line">probas_ &#x3D; eclf.predict_proba(test_feature_extract) # 训练模型后预测每条样本得到两种结果的概率</span><br><span class="line">fpr, tpr, thresholds &#x3D; roc_curve(test_label, probas_[:, 1])    # 该函数得到伪正例、真正例、阈值，这里只使用前两个</span><br><span class="line">roc_auc &#x3D; auc(fpr, tpr)  # 求auc面积</span><br><span class="line">plt.plot(fpr, tpr, lw&#x3D;1, label&#x3D;&#39;ROC (area &#x3D; &#123;1:.2f&#125;)&#39;.format(i, roc_auc))    # 画出当前分割数据的ROC曲线</span><br><span class="line"> </span><br><span class="line">plt.plot([0, 1], [0, 1], &#39;--&#39;, color&#x3D;(0.6, 0.6, 0.6), label&#x3D;&#39;Luck&#39;) # 画对角线</span><br><span class="line">plt.xlim([-0.05, 1.05])     # 设置x、y轴的上下限，设置宽一点，以免和边缘重合，可以更好的观察图像的整体</span><br><span class="line">plt.ylim([-0.05, 1.05])</span><br><span class="line">plt.xlabel(&#39;False Positive Rate&#39;)</span><br><span class="line">plt.ylabel(&#39;True Positive Rate&#39;)    # 可以使用中文，但需要导入一些库即字体</span><br><span class="line">plt.title(&#39;ROC curve&#39;)</span><br><span class="line">plt.legend(loc&#x3D;&quot;lower right&quot;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%99%BA%E8%83%BD%E6%B1%BD%E8%BD%A6/4.png" alt="集成后模型的ROC曲线"></p>
<h3 id="结果分析"><a href="#结果分析" class="headerlink" title="结果分析"></a><strong>结果分析</strong></h3><p>在实际的业务问题中，不能简单的通过准确率，召回率或者精确率来评估阈值。换言之，对于口碑至上的名车厂而言，对miss fault（把健康状况不良的车辆看成好的）的容忍度对falsely predict（把健康状况良好的汽车错误当成不好的）的容忍度要低很多。前者意味着安全和品牌的声誉，后者只是需要额外付出财力。这两者之间的代价关系和权重需要有专门的研究。</p>
<p>在这个问题中，我们简单地把$ miss fault $代价是500，$falsely$ $predict$代价是10，那么我们需要找到一个阈值，使得总代价$ cost $最小。</p>
<script type="math/tex; mode=display">
cost=1000*num_mf+10*num_fp</script><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">## TODO：找阈值使得cost最小</span><br><span class="line">thresholds&#x3D;[0.8,0.81,0.812,0.813,0.814,0.815,0.816,0.817,0.818,0.819,0.82]</span><br><span class="line">cost&#x3D;500*16000</span><br><span class="line">for i in thresholds:</span><br><span class="line">    probas_ &#x3D; eclf.predict_proba(test_feature_extract) # 训练模型后预测每条样本得到两种结果的概率</span><br><span class="line">    arr&#x3D;probas_[:,1]</span><br><span class="line">    arr[arr &gt; i] &#x3D; 1</span><br><span class="line">    arr[arr &lt;&#x3D; i] &#x3D; 0</span><br><span class="line">    y_predict&#x3D;arr</span><br><span class="line">    def TN(y_true, y_predict):</span><br><span class="line">        assert len(y_true) &#x3D;&#x3D; len(y_predict)  </span><br><span class="line">        return np.sum((y_true&#x3D;&#x3D;0)&amp;(y_predict&#x3D;&#x3D;0))</span><br><span class="line">    def FP(y_true, y_predict):</span><br><span class="line">        assert len(y_true) &#x3D;&#x3D; len(y_predict)</span><br><span class="line">        return np.sum((y_true&#x3D;&#x3D;0)&amp;(y_predict&#x3D;&#x3D;1))</span><br><span class="line">    cost_temp&#x3D;500*FP(test_label,arr)+10*TN(test_label,arr)</span><br><span class="line">    if cost_temp&lt;cost:</span><br><span class="line">        cost&#x3D;cost_temp </span><br><span class="line">        thresholds_best&#x3D;i</span><br><span class="line">print(cost,thresholds_best)      </span><br><span class="line">#阈值在0.814左右cost最小，最佳。即当概率小于0.814时，车即被判为性能不正常进行检修</span><br></pre></td></tr></table></figure>
<p>最后得出的结果显示，阈值为0.814时，总代价$ cost $最小。也就是，当阈值大于0.814时，车被判为健康状况不良进行检修，对车厂的效率是最高的。</p>
<p>对于这类不同的分类错误会导致不同的惩罚力度时如何训练分类器的问题，除了阈值的筛选，还有一些前沿的解决方法，称为代价敏感的学习方法<a href="#_edn3">[iii]</a>。代价敏感学习的算法研究又可以分成三类：</p>
<p>（1）直接构造一个代价敏感的学习模型；</p>
<p>（2）基于对分类结果的后处理，即按照传统的学习方法学习一个分类模型，然后对其分类结果按照贝叶斯风险理论对结果进行调整，以达到最小的损失。</p>
<p>（3）基于传统的学习模型，通过改变原始训练数据的分布来训练得到代价敏感的模型。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h3><p>在本项目中，我们对智能汽车传感器的数据应用了机器学习的方法来判断汽车的健康状况，通过数据清洗、特征选择、模型集成等方法，测试集上的分类的准确率达到94%。同时，在最后一部分，我们根据实际情况对阈值进行重新考量，建立车厂召回汽车的代价函数，让车厂在选择召回汽车的决策中效率最佳。</p>
<hr>
<p><a href="#_ednref1">[i]</a> 汽车传感器：智能汽车的感知与计算</p>
<p><a href="#_ednref2">[ii]</a> 机器学习：处理不平衡数据的5个重要技术</p>
<p><a href="#_ednref3">[iii]</a> 代价敏感分类算法的实验比较。闫明松，周志华。模式识别与人工智能。Vol.18 No.5。Oct 2005</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/15/PID%E6%8E%A7%E5%88%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/15/PID%E6%8E%A7%E5%88%B6/" itemprop="url">PID控制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-15T23:09:42+08:00">
                2020-05-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BB%8A%E5%A4%A9%E6%88%91%E5%AD%A6%E4%BA%86%E5%95%A5/" itemprop="url" rel="index">
                    <span itemprop="name">今天我学了啥</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  0
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/07/5-7diary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/07/5-7diary/" itemprop="url">5.7diary</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-07T14:20:58+08:00">
                2020-05-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BB%8A%E5%A4%A9%E6%88%91%E5%AD%A6%E4%BA%86%E5%95%A5/" itemprop="url" rel="index">
                    <span itemprop="name">今天我学了啥</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  1.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>修改辐射制冷Review的Introduction部分，熟悉科技论文写作。</p>
<p><strong><em>It’s one of those “forest and tree” situations: in a research report, the scientists are examining a tree; in a review paper, the scientist is looking at the forest.</em></strong></p>
</li>
<li><p>这篇review写作从开始下笔到只剩下Introduction和Outlook其实只花了我大概三个礼拜时间，中途还有四天时间去参加了美赛（但那些天真的是对着电脑从早上八点到晚上十一点，剩下一个支离破碎的腰椎。）主体部分完工之后写Introduction和Ourlook却憋了我快半个月，一直到三月中旬才写出一个样子来，并且现在仍然对自己的英文表述和看法非常不自信。这也不得不让我承认事情：<strong>简介和展望</strong>确实是论文撰写中最最最困难的部分，尤其是对于本身在这个领域没有经历过长期摸爬滚打的小白……</p>
</li>
</ul>
<p><img src="/2020/05/07/5-7diary/1.png" alt></p>
<ul>
<li><p>搜集了一些关于Introduction/discussion怎么写的指导，摘录在这里，小朋友，理论基础要打牢，避免想当然走弯路，前人的经验还是可以看一看的。</p>
</li>
<li><p>摘自科罗拉多州立大学写作指南</p>
<blockquote>
<h4 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h4><p>The introduction of your review should accomplish three things:</p>
<ul>
<li>Introduce your topic 介绍你的主题（它可能是个陌生的概念）<ul>
<li>It may sound redundant to “introduce” your topic in the introduction, but often times writer’s fail to do so. Let the reader in on background information specific to the topic, define terms that may be unfamiliar to them, explain the scope of the discussion, and your purpose for writing the review.</li>
</ul>
</li>
<li>State your topic’s relevance 介绍跟这个主题相关的背景（目前发展的情况，要有对话感，让没有接触过这个领域的人能建立起思想框架）<ul>
<li>Think of your review paper as a statement in the larger conversation of your academic community. Your review is your way of entering into that conversation and it is important to briefly address why your review is relevant to the discussion. You may feel the relevance is obvious because you are so familiar with the topic, but your readers have not yet established that familiarity.</li>
</ul>
</li>
<li>Reveal your thesis to the reader 将接下来的几个部分陈述一遍<ul>
<li>The thesis is the main idea that you want to get across to your reader. your thesis should be a clear statement of what you intend to prove or illustrate by your review. By revealing your thesis in the introduction the reader knows what to expect in the rest of the paper.</li>
</ul>
</li>
</ul>
<h4 id="Discussion"><a href="#Discussion" class="headerlink" title="Discussion"></a>Discussion</h4><p>The discussion section is the body of your paper. The discussion section contains information that develops and supports your thesis. While there is no particular form that a discussion section must take there are several considerations that a writer must follow when building a discussion.</p>
<ul>
<li><p>Don’t summarize! 不能总结，总结在conclusion里面</p>
<ul>
<li>A review paper is not simply a summary of literature you have reviewed. Be careful not to leave out your own analysis of the ideas presented in the literature. Synthesize the material from all the works—what are the connections you see, or the connections you are trying to illustrate, among your readings.</li>
</ul>
</li>
<li><p>Analyze, Synthesize, Interpret.要分析……（最困难的部分），拒绝单纯的将事实和研究拼凑在一起。</p>
<p>简单的分析方法比如找关联：按照时间线找关联，按照逻辑关系找关联；</p>
<p>找对比：两种方法论有什么区别，好处和坏处、适用的范围；等</p>
<p>找意义：这件事对后来该领域的转变又多大的启发，对未来有什么启发；</p>
<ul>
<li>A review paper is not a pure summary of the information you read for your review. You are required to analyze, synthesize, and interpret the information you read in some meaningful way. It is not enough to simply present the material you have found, you must go beyond that and explain its relevance and significance to the topic at hand. Establish a clear thesis from the onset of your writing and examine which pieces of your reading help you in developing and supporting the ideas in your thesis.</li>
</ul>
</li>
<li><p>Stay focused.</p>
<ul>
<li>Keep your discussion focused on your topic and more importantly your thesis. Don’t let tangents or extraneous material get in the way of a concise, coherent discussion. A well focused paper is crucial in getting your message across to your reader.</li>
</ul>
</li>
<li><p>Organize your points.</p>
<ul>
<li>Keeping your points organized makes it easier for the reader to follow along and make sense of your review. Start each paragraph with a topic sentence that relates back to your thesis. The headings used for this guide give you some idea of how to organize the overall paper, but as far as the discussion section goes use meaningful subheadings that relate to your content to organize your points.</li>
</ul>
</li>
<li><p>Relate the discussion to your thesis.</p>
<ul>
<li>Your thesis should illustrate your objectives in writing the review and your discussion should serve to accomplish your objectives. Make sure your keep your discussion related to the thesis in order to meet your objectives. If you find that your discussion does not relate so much to your thesis, don’t panic, you might want to revise your thesis instead of reworking the discussion.</li>
</ul>
</li>
</ul>
<h4 id="Conclusions"><a href="#Conclusions" class="headerlink" title="Conclusions"></a>Conclusions</h4><p>Because the conclusions section often gets left for last it is often the weakest part of a student review paper. It is as crucial a part of the paper as any and should be treated as such.</p>
<p>A good conclusion should illustrate the key connections between your major points and your thesis as well as they key connections between your thesis and the broader discussion—what is the significance of your paper in a larger context? Make some <em>conclusions</em>—where have you arrived as a result of writing this paper?</p>
<p>Be careful not to present any new information in the conclusion section.</p>
</blockquote>
</li>
<li><p>另一个版本来自弗罗里达州立大学的Thesis Writing in the Sciences</p>
<blockquote>
<p>首先它给出了Review和Paper的不同</p>
<p>In contrast to research papers, conference presentations, and proposals, a review paper is a journal article that <strong>synthesizes</strong> work by many independent researchers on a particular subject or scientific problem. By bringing together the most pertinent findings of a large number of studies, a review paper serves as a <strong>valuable summary</strong> of research. Although it does not present the writer’s new discoveries, it does reflect his or her painstaking review of the literature in a defined field. Moreover, a good review not only summarizes information but also provides <strong>interpretative analysis</strong> and sometimes a <strong>historical perspective</strong>. Reviews may vary in aims, scope, length, and format, but they all include a relatively lengthy reference section. Journal editors sometimes invite prominent experts to write reviews of their particular fields, since the ability to give an audience an authoritative overview of a subject usually develops with experience. Whether solicited or unsolicited, review papers still must conform to journal specifications, and their author receive feedback from editors and reviewers before final publication.</p>
<p>接着展示了一个简介写作的典范</p>
<p>The images below this one show a typical Review Introduction in medicine. It is brief and leads the reader quickly to where the information in the paper happens: the body.</p>
<p><img src="/2020/05/07/5-7diary/review_intro_example.bmp" alt></p>
<p><img src="/2020/05/07/5-7diary/reivew_intro_example_overview.bmp" alt></p>
<p>很容易遗忘的是Gap部分。要时刻记住，你是对这个领域有洞察，那么就要有批判性的眼光，从历史的角度去衡量哪些部分是做的远远不够的，是限制这个领域发展的。然后给致力于研究的同仁提出一些建议。</p>
</blockquote>
</li>
<li><p>在吃饭时观看3Blue1Brown关于线性代数本质的视频，并且大喊“卧槽”。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/" itemprop="url">如何用MATLAB在计算资源有限的树莓派ARM CPU上运行复杂深度神经网络</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-04T21:17:51+08:00">
                2020-05-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MATLAB%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">MATLAB进阶学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  765
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="前言"><strong>前言</strong></h4>
<p>本人作为传统工科出身的朋友，专业之余学过一些机器学习和深度学习的理论，了解一些基本的代码原理和架构。同时呢，因为本专业的训练，对控制技术也有（只限于课本的）了解。但是由于没有进行过实践，一直以来对算法和控制的认识都比较割裂，对两者之间如何搭建起桥梁也云里雾里。今天我在MATHWORKS上听了一节关于如何在计算资源有限的树莓派（Raspberry Pi）ARM CPU上运行复杂深度神经网络的讲座，MATLAB在其中起到了重要作用。我将讲座中进行的重要步骤和提要记在下面。形成一个框架，细节可以用到了慢慢填。</p>
<p><img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/%207%207.png"></p>
<p>Demo 1:训练网络。该步骤使用了迁移学习的思想，用了SqueezeNet模型</p>
<p>Demo 2:将神经网络部署到树莓派的CPU中，其中涉及到将预训练网络自动生成C++代码</p>
<p>Demo 3:将神经网络部署到NVIDIA GPU上，其中涉及到将预训练网络自动生成CUDA代码</p>
<h4 id="连接准备"><strong>连接准备</strong></h4>
<h5 id="安装树莓派和网络摄像头同时配置">安装树莓派和网络摄像头，同时配置</h5>
<h5 id="确认和测试命令行输入webcam确认已经连接获取硬件信息">确认和测试：命令行输入webcam，确认已经连接，获取硬件信息</h5>
<figure>
<img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/%203%203.png" alt="配置外部硬件"><figcaption>配置外部硬件</figcaption>
</figure>
<figure>
<img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/%204%204.png" alt="硬件支持包界面"><figcaption>硬件支持包界面</figcaption>
</figure>
<h5 id="nvidia-gpu配置">NVIDIA GPU配置：</h5>
<p><img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/%205%205.png"></p>
<h5 id="确认输入coder.checkgpuinstall确认硬件已经连接检查环境">确认：输入coder.checkGpuInstall，确认硬件已经连接，检查环境</h5>
<h4 id="预训练squeezenet神经网络在gpu上实现"><strong>预训练Squeezenet神经网络，在GPU上实现</strong></h4>
<p>此处用迁移学习实现图像识别，一般在应用时只需要优化最后几层的参数，前面特征提取的参数都做的挺好的了。</p>
<p><img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/%209%209.png"></p>
<p><img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/%208%208.png"></p>
<h5 id="收集和分类数据">收集和分类数据</h5>
<h5 id="准备训练及测试图片集">准备训练及测试图片集</h5>
<p>载入图库----&gt;加载Squeezenet模型并且修改----&gt;调整图库------&gt;进行模型训练----&gt;测试----&gt;导出模型到.mat文件</p>
<p>注：模型训练中的代码段...,‘ExecutionEnvironment’选项为'gpu'，适用GPU加速</p>
<p><img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/屏幕快照%202020-05-13%20下午9.38.14.png"></p>
<h4 id="自动生成c代码"><strong>自动生成C++代码</strong></h4>
<p>通过cnncodegen转化成C++代码集：</p>
<ul>
<li>本机环境预设置</li>
<li>cnncodegen（net,'targetlab','libraryname'）;树莓派选择'arm-computer'</li>
<li>提供主函数，手写main</li>
</ul>
<figure>
<img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/屏幕快照%202020-05-13%20下午9.30.11.png" alt="目标器件为ARM的cnncongegen流程"><figcaption>目标器件为ARM的cnncongegen流程</figcaption>
</figure>
<h4 id="在树莓派上进行部署和推断"><strong>在树莓派上进行部署和推断</strong></h4>
<p>以下是在树莓派上进行推断的结构图，net.predict(in)处需要放入训练过的模型生成好的C++程序</p>
<p>在树莓派中构建基于ARM Compute Library的可执行程序</p>
<p><img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/屏幕快照%202020-05-13%20下午9.32.07.png"></p>
<p><img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/%2012%2012.png"></p>
<p>运行结果</p>
<figure>
<img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/屏幕快照%202020-05-13%20下午9.45.11.png" alt="99.4%正确率，374ms的腿短时间"><figcaption>99.4%正确率，374ms的腿短时间</figcaption>
</figure>
<h4 id="总结"><strong>总结</strong></h4>
<p>回答一下最初的疑惑，算法如何在控制器上体现可以总结为如下框图：</p>
<p>算法设计----应用设计----独立部署</p>
<p>其中MATLAB起到的作用有，存储数据，设计神经网络（可以借助大牛们搭好的），借用GPU进行训练，将过程可视化。打包模型之后也能在MATLAB中可以生成C++代码和CUDA代码，独立部署到需要的树莓派/GPU/CPU中去。</p>
<p><img src="/2020/05/04/MATLAB%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B5%8C%E5%85%A5/%2013%2013.png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/04/Never%20Waste%20A%20Crisis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/04/Never%20Waste%20A%20Crisis/" itemprop="url">Never Waste A Crisis</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-04T13:56:17+08:00">
                2020-05-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%97%B2%E6%95%A3%E8%AE%AE%E7%90%86/" itemprop="url" rel="index">
                    <span itemprop="name">闲散议理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  268
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>上周日（5月3日）晚，我在Zoom上参加了梅尔顿基金会（Melton Foundation）举行的<strong># Quarantine with me</strong>的活动。这个系列的活动由基金会在Covid-19全球隔离期间举办。活动的初衷是通过搭建基金会成员间直接、真诚、开放的讨论，越过充斥政治和偏见的媒介来分享观察、了解世界，加强并表达了我们共同致力于解决当今相互联系的世界中紧迫问题的承诺。</p>
<p>周日的活动同时也作为一年一度的Melton Day的特别分享，因此规模也很大，非常有幸在会议上见到了<strong>创始人Bill Melton</strong>以及许多如今在世界各个角落发挥影响力的Melton Family的前辈们。这次活动重点讨论<strong>Covid-19</strong>所带来的<strong>经济和社会影响</strong>。我们将讨论可能会从危机中摆脱出来的新的经济模式，并探讨持久的封锁和即将到来的经济衰退对社会的影响。</p>
<p><img src="/2020/05/04/Never%20Waste%20A%20Crisis/1.png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/01/MATLAB&Simulink%20%E5%BC%80%E5%8F%91%E8%87%AA%E5%8A%A8%E5%8C%96%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ren Yixin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yixin's sharing">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/01/MATLAB&Simulink%20%E5%BC%80%E5%8F%91%E8%87%AA%E5%8A%A8%E5%8C%96%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/" itemprop="url">电车队分享：利用MATLAB & Simulink 开发自动化与可视化数据分析工具</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-01T16:56:17+08:00">
                2020-05-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MATLAB%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">MATLAB进阶学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  915
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天晚上听了MathWorks官网上的一个关于提高数据处理效率的分享。分享由同济电车队的队长马家骏与 MathWorks 中国工程师董淑成共同进行，讲述了车队如何在测试阶段运用MATLAB工具提升调教、Debug与验证工作的效率，从而腾出时间做更有价值的工作。</p>
<p><strong>工具的本质就是为了提高效率。——Yixin</strong></p>
<p><strong>车队所用到的工具链概览：</strong></p>
<ul>
<li>控制算法的快速原型开发——Simulink+快速原型控制器</li>
<li>数据分析与可视化——MATLAB</li>
<li>试车数据的记录——CAN记录仪</li>
</ul>
<p>对于赛车控制系统的开发和调试，数据分析的好处可谓至关重要：指导开发方向，提高开发速度，加快迭代速度等。然而直接在操作界面上进行数据分析不仅耗时，对各种类型的终端用户都不友好（例如团队中有不会MATLAB或没有Liscense的同学就比较麻烦）。之后的分享中，马家骏针对以上痛点介绍了电车队在调试中使用四个帮助提升开发效率的小技巧。</p>
<h3 id="利用matlab-gui进行简易数据可视化软件的开发">1. 利用MATLAB GUI进行简易数据可视化软件的开发</h3>
<ul>
<li><p>分析数据时重复输入代码</p></li>
<li><p>有限的MATLAB License</p></li>
<li><p>该步骤其实就是把流水化的可视化步骤打包起来，用GUI做界面，GUI的相关知识之后我会进行补充。</p>
<p><img src="/2020/05/01/MATLAB&Simulink%20%E5%BC%80%E5%8F%91%E8%87%AA%E5%8A%A8%E5%8C%96%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/1.png"></p>
<p><strong>基于MATLAB GUI开发的简易可视化软件：</strong></p></li>
</ul>
<p><img src="/2020/05/01/MATLAB&Simulink%20%E5%BC%80%E5%8F%91%E8%87%AA%E5%8A%A8%E5%8C%96%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/2.png"></p>
<h3 id="自动化的数据分析算法">2. 自动化的数据分析算法</h3>
<ul>
<li><p>车辆的驱动防滑算法的PID模块的参数标定过程，需要对实车试验数据进行大量的分析</p></li>
<li><p>通过算法自动判断车辆直线加速的开始与结束，自动得到车辆在某一标定值夏的加速性能，帮助快速筛选出最优标定参数——方向盘上有可调PID的按钮，根据不同路况自动设置。</p>
<p><img src="/2020/05/01/MATLAB&Simulink%20%E5%BC%80%E5%8F%91%E8%87%AA%E5%8A%A8%E5%8C%96%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/3.png"></p>
<p>PID的调节是一个比较复杂的过程，有了这一步对判断参数优劣、快速筛选提供依据。这让我想起了智能焊机项目进行时，学长就系数控制中PID的参数标定做了很长时间，也许这个可视化会是一个节省时间的好方法。</p></li>
</ul>
<h3 id="用于数据分析的车辆轨迹重建">3. 用于数据分析的车辆轨迹重建</h3>
<ul>
<li>当一个赛车手再反馈问题时，往往记得“第几个弯、什么地形”，而通常不是“几分几秒”，为了数据反馈和处理相连接，方便快速迭代，电车队利用MATLAB重建了车辆轨迹，将数据域从时间转到了赛道上。
<ul>
<li>更直观的分析，颜色深浅对应车速</li>
<li>收集赛道数据——GPS（精度不够）/光学传感器</li>
<li>方便进行调试——例如，当车手提出第三个弯发生了甩尾现象，后台工程师可以针对传感器中该场景下转弯前赛车速度、转弯后赛车速度、弯角等信息对车辆调教，设置该场景下适宜的控制参数。</li>
</ul></li>
</ul>
<p><img src="/2020/05/01/MATLAB&Simulink%20%E5%BC%80%E5%8F%91%E8%87%AA%E5%8A%A8%E5%8C%96%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/4.png"></p>
<h3 id="simulink脚本建立数据回放接口">4. Simulink脚本建立数据回放接口</h3>
<ul>
<li>数据分析时需要回放数据到Simulink模型</li>
<li>传统的方法是手动创建fromworkspace模块，工作重复，输入多的话很耗时间。</li>
<li>直接读取数据，建立Simulink bus对象，实现一键导入数据——<strong>非常常用的操作：Matlab/simulink用脚本批量创建接口、设置属性、自动对齐等</strong>，能大幅度提升大模型中数据导入的效率。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Ren Yixin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ren Yixin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">26.6k</span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>



<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共26.6k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
